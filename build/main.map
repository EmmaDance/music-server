{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/auth/index.js","webpack:///./src/auth/router.js","webpack:///./src/auth/store.js","webpack:///./src/core/Issue.js","webpack:///./src/core/ValidationError.js","webpack:///./src/core/index.js","webpack:///./src/core/wsBroadcast.js","webpack:///./src/index.js","webpack:///./src/item/Activity.js","webpack:///./src/item/activityRouter.js","webpack:///./src/item/activityStore.js","webpack:///./src/utils/index.js","webpack:///external \"@koa/cors\"","webpack:///external \"fs\"","webpack:///external \"http\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-jwt\"","webpack:///external \"koa-router\"","webpack:///external \"nedb-promise\"","webpack:///external \"ws\""],"names":["jwtConfig","secret","router","Router","createToken","user","jwt","sign","username","_id","expiresIn","createUser","response","userStore","insert","body","token","status","err","issue","error","message","post","ctx","request","credentials","findOne","password","UserStore","constructor","filename","autoload","store","dataStore","props","SEVERITY","ERROR","WARNING","INFO","Issue","severity","code","details","ValidationError","Error","issues","wss","init","webSocketServer","broadcast","data","clients","forEach","ws","readyState","WebSocket","OPEN","send","JSON","stringify","app","Koa","server","require","createServer","callback","Server","use","cors","on","console","log","parse","decoded","jsonWebToken","verify","bodyParser","count","logger","errorHandler","publicRouter","itemRouter","routes","allowedMethods","listen","Activity","id","title","time","isDone","prototype","toString","validate","trim","length","push","fs","items","ActivityStore","get","next","readFileSync","match","item","keys","Object","i","key","db","find","update","remove","ccount","datastore","ensureValidItem","it","ItemStore","start","Date","now","method","idGenerator"],"mappings":";;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AChFA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEO,MAAMA,SAAS,GAAG;AAAEC,QAAM,EAAE;AAAV,CAAlB;AACA,MAAMC,MAAM,GAAG,IAAIC,iDAAJ,EAAf;;AAEP,MAAMC,WAAW,GAAIC,IAAD,IAAU;AAC1B,SAAOC,mDAAG,CAACC,IAAJ,CAAS;AAAEC,YAAQ,EAAEH,IAAI,CAACG,QAAjB;AAA2BC,OAAG,EAAEJ,IAAI,CAACI;AAArC,GAAT,EAAqDT,SAAS,CAACC,MAA/D,EAAuE;AAAES,aAAS,EAAE,KAAK,EAAL,GAAU;AAAvB,GAAvE,CAAP;AACH,CAFD;;AAIA,MAAMC,UAAU,GAAG,OAAON,IAAP,EAAaO,QAAb,KAA0B;AACzC,MAAI;AACA,UAAMC,8CAAS,CAACC,MAAV,CAAiBT,IAAjB,CAAN;AACAO,YAAQ,CAACG,IAAT,GAAgB;AAAEC,WAAK,EAAEZ,WAAW,CAACC,IAAD;AAApB,KAAhB;AACAO,YAAQ,CAACK,MAAT,GAAkB,GAAlB,CAHA,CAGuB;AAC1B,GAJD,CAIE,OAAOC,GAAP,EAAY;AACVN,YAAQ,CAACG,IAAT,GAAgB;AAAEI,WAAK,EAAE,CAAC;AAAEC,aAAK,EAAEF,GAAG,CAACG;AAAb,OAAD;AAAT,KAAhB;AACAT,YAAQ,CAACK,MAAT,GAAkB,GAAlB,CAFU,CAEa;AAC1B;AACJ,CATD;;AAWAf,MAAM,CAACoB,IAAP,CAAY,SAAZ,EAAuB,MAAOC,GAAP,IAAe,MAAMZ,UAAU,CAACY,GAAG,CAACC,OAAJ,CAAYT,IAAb,EAAmBQ,GAAG,CAACX,QAAvB,CAAtD;AAEAV,MAAM,CAACoB,IAAP,CAAY,QAAZ,EAAsB,MAAOC,GAAP,IAAe;AACjC,QAAME,WAAW,GAAGF,GAAG,CAACC,OAAJ,CAAYT,IAAhC;AACA,QAAMH,QAAQ,GAAGW,GAAG,CAACX,QAArB;AACA,QAAMP,IAAI,GAAG,MAAMQ,8CAAS,CAACa,OAAV,CAAkB;AAAElB,YAAQ,EAAEiB,WAAW,CAACjB;AAAxB,GAAlB,CAAnB;;AACA,MAAIH,IAAI,IAAIoB,WAAW,CAACE,QAAZ,KAAyBtB,IAAI,CAACsB,QAA1C,EAAoD;AAChDf,YAAQ,CAACG,IAAT,GAAgB;AAAEC,WAAK,EAAEZ,WAAW,CAACC,IAAD;AAApB,KAAhB;AACAO,YAAQ,CAACK,MAAT,GAAkB,GAAlB,CAFgD,CAEzB;AAC1B,GAHD,MAGO;AACHL,YAAQ,CAACG,IAAT,GAAgB;AAAEI,WAAK,EAAE,CAAC;AAAEC,aAAK,EAAE;AAAT,OAAD;AAAT,KAAhB;AACAR,YAAQ,CAACK,MAAT,GAAkB,GAAlB,CAFG,CAEoB;AAC1B;AACJ,CAXD,E;;;;;;;;;;;;ACxBA;AAAA;AAAA;AAAA;AAAA;AAEO,MAAMW,SAAN,CAAgB;AACnBC,aAAW,CAAC;AAAEC,YAAF;AAAYC;AAAZ,GAAD,EAAyB;AAChC,SAAKC,KAAL,GAAaC,mDAAS,CAAC;AAAEH,cAAF;AAAYC;AAAZ,KAAD,CAAtB;AACH;;AAED,QAAML,OAAN,CAAcQ,KAAd,EAAqB;AACjB,WAAO,KAAKF,KAAL,CAAWN,OAAX,CAAmBQ,KAAnB,CAAP;AACH;;AAED,QAAMpB,MAAN,CAAaT,IAAb,EAAmB;AACf,WAAO,KAAK2B,KAAL,CAAWlB,MAAX,CAAkBT,IAAlB,CAAP;AACH;;AAXkB;AAcR,mEAAIuB,SAAJ,CAAc;AAAEE,UAAQ,EAAE,iBAAZ;AAA+BC,UAAQ,EAAE;AAAzC,CAAd,CAAf,E;;;;;;;;;;;;AChBA;AAAA;AAAA;AAAO,MAAMI,QAAQ,GAAG;AACpBC,OAAK,EAAE,OADa;AAEpBC,SAAO,EAAE,SAFW;AAGpBC,MAAI,EAAE;AAHc,CAAjB,C,CAIJ;AACH;AAEA;;AAEO,SAASC,KAAT,CAAeC,QAAf,EAAyBC,IAAzB,EAA+BC,OAA/B,EAAwC;AAC3C,OAAKF,QAAL,GAAgBA,QAAhB;AACA,OAAKC,IAAL,GAAYA,IAAZ;AACA,OAAKC,OAAL,GAAeA,OAAf;AACH,C;;;;;;;;;;;;ACbD;AAAA;AAAO,MAAMC,eAAN,SAA8BC,KAA9B,CAAoC;AACvCf,aAAW,CAACgB,MAAD,EAAS;AAChB,UAAM,kBAAN;AACA,SAAKA,MAAL,GAAcA,MAAd;AACH;;AAJsC,C;;;;;;;;;;;;ACA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;ACDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,IAAIC,GAAJ;AACO,MAAMC,IAAI,GAAGC,eAAe,IAAI;AACnCF,KAAG,GAAGE,eAAN;AACH,CAFM;AAGA,MAAMC,SAAS,GAAGC,IAAI,IAAI;AAC7B,MAAI,CAACJ,GAAL,EACI;AACJA,KAAG,CAACK,OAAJ,CAAYC,OAAZ,CAAqBC,EAAD,IAAM;AACtB;AACA,QAAGA,EAAE,CAACC,UAAH,KAAkBC,yCAAS,CAACC,IAA/B,EAAoC;AAChCH,QAAE,CAACI,IAAH,CAAQC,IAAI,CAACC,SAAL,CAAeT,IAAf,CAAR;AACH;AACJ,GALD;AAMH,CATM,C;;;;;;;;;;;;ACNP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,MAAMU,GAAG,GAAG,IAAIC,0CAAJ,EAAZ;;AACA,MAAMC,MAAM,GAAGC,mBAAO,CAAC,kBAAD,CAAP,CAAgBC,YAAhB,CAA6BJ,GAAG,CAACK,QAAJ,EAA7B,CAAf;;AACA,MAAMnB,GAAG,GAAG,IAAIS,yCAAS,CAACW,MAAd,CAAqB;AAACJ;AAAD,CAArB,CAAZ;AACAf,kDAAI,CAACD,GAAD,CAAJ;AACAc,GAAG,CAACO,GAAJ,CAAQC,gDAAI,EAAZ;AACAtB,GAAG,CAACuB,EAAJ,CAAO,YAAP,EAAqBhB,EAAE,IAAI;AACvBiB,SAAO,CAACC,GAAR,CAAY,mBAAZ;AACAlB,IAAE,CAACgB,EAAH,CAAM,SAAN,EAAiBhD,OAAO,IAAI;AACxBiD,WAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BlD,OAA5B;AACA,UAAM;AAAEL;AAAF,QAAa0C,IAAI,CAACc,KAAL,CAAWnD,OAAX,CAAnB;;AACA,QAAG;AACC,UAAIoD,OAAO,GAAGC,mDAAY,CAACC,MAAb,CAAoB3D,KAApB,EAA2BhB,+CAAS,CAACC,MAArC,CAAd;AACAqE,aAAO,CAACC,GAAR,CAAY,WAAZ,EAAwBE,OAAxB;AACApB,QAAE,CAAChD,IAAH,GAAQoE,OAAR;AAGH,KAND,CAME,OAAOvD,GAAP,EAAY;AACVoD,aAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,aAAO,CAAClD,KAAR,CAAcF,GAAd;AACH;AACJ,GAbD;AAcH,CAhBD;AAkBA0C,GAAG,CAACO,GAAJ,CAAQS,qDAAU,EAAlB;AAEA,IAAIC,KAAK,GAAG,CAAZ;AACAjB,GAAG,CAACO,GAAJ,CAAQW,6CAAR;AACAlB,GAAG,CAACO,GAAJ,CAAQY,mDAAR,E,CAEA;;AAEA,MAAMC,YAAY,GAAG,IAAI7E,iDAAJ,EAArB;AACA6E,YAAY,CACPb,GADL,CACS,QADT,EACmBc,4DAAU,CAACC,MAAX,EADnB;AAEAtB,GAAG,CACEO,GADL,CACSa,YAAY,CAACE,MAAb,EADT,EAEKf,GAFL,CAESa,YAAY,CAACG,cAAb,EAFT;AAIArB,MAAM,CAACsB,MAAP,CAAc,IAAd,E;;;;;;;;;;;;ACnDA;AAAA;CAA2C;;AAE3C,SAASC,QAAT,CAAkBC,EAAlB,EAAsBC,KAAtB,EAA6BC,IAAI,GAAC,EAAlC,EAAsCC,MAAM,GAAC,KAA7C,EAAoD;AAChD,OAAKH,EAAL,GAAUA,EAAV;AACA,OAAKC,KAAL,GAAaA,KAAb;AACA,OAAKC,IAAL,GAAYA,IAAZ;AACA,OAAKC,MAAL,GAAcA,MAAd;AACH,C,CAED;;;AACAJ,QAAQ,CAACK,SAAT,CAAmBC,QAAnB,GAA8B,YAAW;AACrC,SAAQ,GAAE,KAAKL,EAAG,IAAG,KAAKC,KAAM,IAAG,KAAKC,IAAK,IAAG,KAAKC,MAAO,EAA5D,CADqC,CACyB;AACjE,CAFD;;AAKAJ,QAAQ,CAACK,SAAT,CAAmBE,QAAnB,GAA8B,YAAW;AACrC,QAAM/C,MAAM,GAAG,EAAf,CADqC,CAErC;;AACA,MAAI,CAAC,KAAK0C,KAAN,IAAe,OAAO,KAAKA,KAAZ,KAAsB,QAArC,IAAiD,KAAKA,KAAL,CAAWM,IAAX,GAAkBC,MAAlB,KAA6B,CAAlF,EAAqF;AACjFjD,UAAM,CAACkD,IAAP,CAAY,IAAIxD,2CAAJ,CAAUJ,8CAAQ,CAACE,OAAnB,EAA4B,OAA5B,EAAqC,wBAArC,CAAZ;AACH;;AACD,MAAK,OAAO,KAAKiD,EAAZ,KAAmB,QAAxB,EAAmC;AAC/BzC,UAAM,CAACkD,IAAP,CAAY,IAAIxD,2CAAJ,CAAUJ,8CAAQ,CAACE,OAAnB,EAA4B,IAA5B,EAAkC,qBAAlC,CAAZ;AACH;;AACD,SAAOQ,MAAP;AACH,CAVD;;AAaewC,uEAAf,E,CAAyB,0H;;;;;;;;;;;;AC5BzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAEA,MAAMW,EAAE,GAAGjC,mBAAO,CAAC,cAAD,CAAlB;;AAEO,MAAM7D,MAAM,GAAG,IAAIC,iDAAJ,EAAf;AAEP,MAAM8F,KAAK,GAAG,IAAIC,4DAAJ,EAAd;AAEAhG,MAAM,CAACiG,GAAP,CAAW,SAAX,EAAsB,OAAO5E,GAAP,EAAY6E,IAAZ,KAAqB;AACvC9B,SAAO,CAACC,GAAR,CAAY,QAAZ;AACA,MAAIrB,IAAI,GAAG8C,EAAE,CAACK,YAAH,CAAgB,8BAAhB,EAAgD,MAAhD,CAAX;AACA9E,KAAG,CAACX,QAAJ,CAAaG,IAAb,GAAoBmC,IAAI,CAACyC,QAAL,EAApB,CAHuC,CAIvC;;AACApE,KAAG,CAACX,QAAJ,CAAaK,MAAb,GAAsB,GAAtB,CALuC,CAKZ;;AAC3BqD,SAAO,CAACC,GAAR,CAAYhD,GAAG,CAACX,QAAJ,CAAaG,IAAzB;AACAuD,SAAO,CAACC,GAAR,CAAY,GAAZ;AACH,CARD,E,CAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEerE,qEAAf,E;;;;;;;;;;;;;;;;;;;;;AC/EA;AACA;AACA;AACA;AACA;;AAGA,MAAMoG,KAAK,GAAG,CAACpE,KAAD,EAAQqE,IAAR,KAAiB;AAC3B,QAAMC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYtE,KAAZ,CAAb;;AACA,OAAK,IAAIwE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACV,MAAzB,EAAiCY,CAAC,EAAlC,EAAsC;AAClC,UAAMC,GAAG,GAAGH,IAAI,CAACE,CAAD,CAAhB;;AACA,QAAIxE,KAAK,CAACyE,GAAD,CAAL,KAAeJ,IAAI,CAACI,GAAD,CAAvB,EAA8B;AAC1B,aAAO,KAAP;AACH;AACJ;;AACD,SAAO,IAAP;AACH,CATD;;AAWO,MAAMT,aAAN,CAAoB;AACvBrE,aAAW,GAAG;AAAA,qCAsBJ,MAAOyD,EAAP,IAAc,KAAKsB,EAAL,CAAQlF,OAAR,CAAgB;AAAE4D,QAAE,EAACA;AAAL,KAAhB,CAtBV;;AAAA,kCAwBP,MAAOpD,KAAP,IAAiB,KAAK0E,EAAL,CAAQC,IAAR,CAAa3E,KAAb,CAxBV;;AAAA,oCA0BL,OAAOA,KAAP,EAAcqE,IAAd,KAAuB,KAAKK,EAAL,CAAQE,MAAR,CAAe5E,KAAf,EAAsBqE,IAAtB,CA1BlB;;AAAA,oCA4BL,MAAOrE,KAAP,IAAiB;AACtBoC,aAAO,CAACC,GAAR,CAAYrC,KAAZ;AACA,WAAK0E,EAAL,CAAQG,MAAR,CAAe7E,KAAf;AACH,KA/Ba;;AAAA,mCAiCN,MAAOA,KAAP,IAAiB,KAAK0E,EAAL,CAAQI,MAAR,CAAe9E,KAAf,CAjCX;;AACV,SAAK0E,EAAL,GAAUK,mDAAS,CAAC;AAChBnF,cAAQ,EAAE,oBADM;AAEhBC,cAAQ,EAAE;AAFM,KAAD,CAAnB;AAKH;;AACD,SAAOmF,eAAP,CAAuBX,IAAvB,EAA6B;AACzB,UAAM1D,MAAM,GAAG0D,IAAI,CAACX,QAAL,EAAf;;AACA,QAAI/C,MAAM,CAACiD,MAAP,GAAgB,CAApB,EAAsB;AAClB,YAAM,IAAInD,qDAAJ,CAAoBE,MAApB,CAAN;AACH;AACJ;;AAED,QAAM/B,MAAN,CAAayF,IAAb,EAAmB;AACf,UAAMY,EAAE,GAAG,IAAI9B,iDAAJ,CAAakB,IAAI,CAACjB,EAAlB,EAAqBiB,IAAI,CAAChB,KAA1B,CAAX;AACA6B,0DAAS,CAACF,eAAV,CAA0BC,EAA1B;AACAA,MAAE,CAAC3B,IAAH,GAAUe,IAAI,CAACf,IAAf;AACA2B,MAAE,CAAC1B,MAAH,GAAYc,IAAI,CAACd,MAAjB;AACA,WAAO,KAAKmB,EAAL,CAAQ9F,MAAR,CAAeqG,EAAf,CAAP;AACH;;AArBsB;AAsCZjB,4EAAf,E;;;;;;;;;;;;ACxDA;AAAA;AAAA;AAAA;AAAO,MAAMnB,YAAY,GAAG,OAAOxD,GAAP,EAAW6E,IAAX,KAAoB;AAAE;AAC9C,MAAI;AACA,WAAO,MAAMA,IAAI,EAAjB;AACH,GAFD,CAEE,OAAOlF,GAAP,EAAY;AACVK,OAAG,CAACR,IAAJ,GAAW;AAAEM,aAAO,EAAEH,GAAG,CAACG,OAAJ,IAAe;AAA1B,KAAX;AACAE,OAAG,CAACN,MAAJ,GAAaC,GAAG,CAACD,MAAJ,IAAc,GAA3B;AACH;AACJ,CAPM;AASA,MAAM6D,MAAM,GAAG,OAAMvD,GAAN,EAAW6E,IAAX,KAAoB;AAAE;AACxC,MAAIiB,KAAK,GAAGC,IAAI,CAACC,GAAL,EAAZ;AACA,QAAMnB,IAAI,EAAV;AACA9B,SAAO,CAACC,GAAR,CAAa,GAAEhD,GAAG,CAACC,OAAJ,CAAYgG,MAAO,IAAGjG,GAAG,CAACC,OAAJ,CAAYT,IAAK,IAAGuG,IAAI,CAACC,GAAL,KAAaF,KAAM,KAA5E;AACH,CAJM,C,CAOP;AACA;AACA;AACA;;AAEO,MAAMI,WAAW,GAAG,CAAC,MAAM;AAC9B,MAAInC,EAAE,GAAG,CAAT,CAD8B,CAClB;;AACZ,SAAO;AACHc,QAAI,EAAE,MAAO,EAAEd;AADZ,GAAP;AAGH,CAL0B,GAApB,C,CAKD,mC;;;;;;;;;;;;;;;;;;;;;;;AC1BN,sC;;;;;;;;;;;ACAA,+B;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,yC;;;;;;;;;;;ACAA,gC;;;;;;;;;;;ACAA,2C;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,uC;;;;;;;;;;;ACAA,yC;;;;;;;;;;;ACAA,+B","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\r\n\r\nexport * from './router'\r\n","import Router from 'koa-router';\r\nimport userStore from './store';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nexport const jwtConfig = { secret: 'my-secret' };\r\nexport const router = new Router();\r\n\r\nconst createToken = (user) => {\r\n    return jwt.sign({ username: user.username, _id: user._id }, jwtConfig.secret, { expiresIn: 60 * 60 * 60 });\r\n};\r\n\r\nconst createUser = async (user, response) => {\r\n    try {\r\n        await userStore.insert(user);\r\n        response.body = { token: createToken(user) };\r\n        response.status = 201; // created\r\n    } catch (err) {\r\n        response.body = { issue: [{ error: err.message }] };\r\n        response.status = 400; // bad request\r\n    }\r\n};\r\n\r\nrouter.post('/signup', async (ctx) => await createUser(ctx.request.body, ctx.response));\r\n\r\nrouter.post('/login', async (ctx) => {\r\n    const credentials = ctx.request.body;\r\n    const response = ctx.response;\r\n    const user = await userStore.findOne({ username: credentials.username });\r\n    if (user && credentials.password === user.password) {\r\n        response.body = { token: createToken(user) };\r\n        response.status = 201; // created\r\n    } else {\r\n        response.body = { issue: [{ error: 'Invalid credentials' }] };\r\n        response.status = 400; // bad request\r\n    }\r\n});\r\n","import dataStore from 'nedb-promise';\r\n\r\nexport class UserStore {\r\n    constructor({ filename, autoload }) {\r\n        this.store = dataStore({ filename, autoload });\r\n    }\r\n\r\n    async findOne(props) {\r\n        return this.store.findOne(props);\r\n    }\r\n\r\n    async insert(user) {\r\n        return this.store.insert(user);\r\n    };\r\n}\r\n\r\nexport default new UserStore({ filename: './db/users.json', autoload: true });\r\n","export const SEVERITY = {\r\n    ERROR: 'error',\r\n    WARNING: 'warning',\r\n    INFO: 'information'\r\n}; //ca si o enumerare, un obiect constant\r\n//export cu nume - din acest modul exportam pt cine il va folosi\r\n\r\n//export const Issue = (severity, code, details) => {\r\n\r\nexport function Issue(severity, code, details) {\r\n    this.severity = severity;\r\n    this.code = code;\r\n    this.details = details;\r\n}","export class ValidationError extends Error {\r\n    constructor(issues) {\r\n        super('validation error');\r\n        this.issues = issues;\r\n    }\r\n}","export * from \"./Issue\";\r\nexport * from \"./ValidationError\";\r\nexport * from \"./wsBroadcast\"","import WebSocket from \"ws\";\r\n\r\nlet wss;\r\nexport const init = webSocketServer => {\r\n    wss = webSocketServer;\r\n}\r\nexport const broadcast = data => {\r\n    if (!wss)\r\n        return;\r\n    wss.clients.forEach((ws)=>{\r\n        // console.log('user: ',ws.user);\r\n        if(ws.readyState === WebSocket.OPEN){\r\n            ws.send(JSON.stringify(data));\r\n        }\r\n    });\r\n}\r\n","import Koa from 'koa';\r\nimport {errorHandler, logger} from './utils';\r\nimport bodyParser from 'koa-bodyparser';\r\nimport WebSocket from 'ws';\r\nimport {init} from './core';\r\nimport cors from '@koa/cors';\r\nimport Router from 'koa-router';\r\nimport itemRouter from './item/activityRouter'\r\nimport {jwtConfig, router as authRouter} from './auth';\r\nimport jsonWebToken from 'jsonwebtoken'\r\nimport jwt from \"koa-jwt\";\r\n\r\n\r\nconst app = new Koa();\r\nconst server = require('http').createServer(app.callback());\r\nconst wss = new WebSocket.Server({server});\r\ninit(wss);\r\napp.use(cors());\r\nwss.on('connection', ws => {\r\n    console.log('Client connected!');\r\n    ws.on('message', message => {\r\n        console.log('received: %s', message);\r\n        const { token }  = JSON.parse(message);\r\n        try{\r\n            var decoded = jsonWebToken.verify(token, jwtConfig.secret);\r\n            console.log('decoded: ',decoded);\r\n            ws.user=decoded;\r\n\r\n\r\n        } catch (err) {\r\n            console.log(\"jwt error\")\r\n            console.error(err);\r\n        }\r\n    });\r\n});\r\n\r\napp.use(bodyParser());\r\n\r\nlet count = 0;\r\napp.use(logger);\r\napp.use(errorHandler);\r\n\r\n// const prefix = '/music';\r\n\r\nconst publicRouter = new Router();\r\npublicRouter\r\n    .use('/score', itemRouter.routes());\r\napp\r\n    .use(publicRouter.routes())\r\n    .use(publicRouter.allowedMethods());\r\n\r\nserver.listen(3000);\r\n\r\n","import { Issue, SEVERITY } from '../core'; //acolade, pt import, apoi numele exportate\r\n\r\nfunction Activity(id, title, time=\"\", isDone=false) {\r\n    this.id = id;\r\n    this.title = title;\r\n    this.time = time;\r\n    this.isDone = isDone;\r\n}\r\n\r\n//orice functie are proprietatea prototype - obiectul care contine functiile comune pe care le au toate obiectele de tip item\r\nActivity.prototype.toString = function() {\r\n    return `${this.id},${this.title},${this.time},${this.isDone}` //backtick, pt evaluarea expresiilor prin concatenare,\r\n};\r\n\r\n\r\nActivity.prototype.validate = function() {\r\n    const issues = [];\r\n    //! this.text -> not undefined, not null, not ''\r\n    if (!this.title || typeof this.title !== 'string' || this.title.trim().length === 0) {\r\n        issues.push(new Issue(SEVERITY.WARNING, 'title', 'Invalid title property'));\r\n    }\r\n    if ( typeof this.id !== 'number' ) {\r\n        issues.push(new Issue(SEVERITY.WARNING, 'id', 'Invalid id property'));\r\n    }\r\n    return issues;\r\n};\r\n\r\n\r\nexport default Activity; //export pt utilizare -> in general un modul exporta un singur obiect, cel care importa poate sa dea orice nume obiectului\r\n","import Router from 'koa-router';\r\nimport {broadcast} from '../core';\r\nimport {ActivityStore} from \"./activityStore\";\r\n\r\nconst fs = require('fs');\r\n\r\nexport const router = new Router();\r\n\r\nconst items = new ActivityStore();\r\n\r\nrouter.get('/sample', async (ctx, next) => {\r\n    console.log(\"sample\");\r\n    let data = fs.readFileSync('db\\\\Glasul_florilor.musicxml', 'utf8');\r\n    ctx.response.body = data.toString();\r\n    // ctx.response.body = {\"data\": data.toString()};\r\n    ctx.response.status = 200; // ok\r\n    console.log(ctx.response.body);\r\n    console.log(200);\r\n});\r\n\r\n// router.get('/:id', async (ctx, next) => {\r\n//     const id = parseInt(ctx.params.id);\r\n//     const item = await items.findOne(id);\r\n//     if (item) {\r\n//         ctx.response.body = item;\r\n//         ctx.response.status = 200;\r\n//     } else {\r\n//         ctx.response.status = 404;\r\n//     }\r\n// });\r\n\r\n// router.post('/', async (ctx, next) => {\r\n//     const item = ctx.request.body; //luam item trimis de client\r\n//     console.log(item);\r\n//     const insertedItem = await items.insert(item);\r\n//     ctx.response.body = insertedItem;\r\n//     ctx.response.status = 200;\r\n//     broadcast(insertedItem);\r\n// });\r\n//\r\n// router.put('/:id', async (ctx, next) => {\r\n//     const item = ctx.request.body;\r\n//     console.log(item);\r\n//     const id = parseInt(ctx.params.id);\r\n//     items.update({id: id}, item);\r\n//     const newItem = await items.findOne(id);\r\n//     ctx.response.body = newItem;\r\n//     ctx.response.status = 200;\r\n//     broadcast(newItem);\r\n// });\r\n//\r\n// // delete item by id\r\n// router.delete('/:id', async (ctx, next) => {\r\n//     const id = parseInt(ctx.params.id);\r\n//     await items.remove({id: id}).then((result) => {\r\n//         ctx.response.body = \"Item was successfully deleted\";\r\n//         ctx.response.status = 200;\r\n//         broadcast([]);\r\n//     }).catch((reject) => {\r\n//         ctx.response.status = 400;\r\n//         ctx.response.body = reject;\r\n//     })\r\n//\r\n// });\r\n//\r\n// // delete item from request body\r\n// router.delete('/', async (ctx, next) => {\r\n//     const props = ctx.request.body;\r\n//     await items.remove(props).then((result) => {\r\n//         ctx.response.status = 200;\r\n//         ctx.response.body = '{\"text\": \"Deleted succesfully\"}';\r\n//         broadcast([])\r\n//     })\r\n//         .catch((reject) => {\r\n//             ctx.response.status = 400;\r\n//             ctx.response.body = reject;\r\n//         })\r\n// });\r\n\r\nexport default router;\r\n","//import Item from './Item' //fara acolade cand e default\r\nimport { ValidationError } from '../core'\r\nimport Activity from \"./Activity\"\r\nimport datastore from 'nedb-promise';\r\nimport ItemStore from './activityStore'\r\n\r\n\r\nconst match = (props, item) => {\r\n    const keys = Object.keys(props);\r\n    for (let i = 0; i < keys.length; i++) {\r\n        const key = keys[i];\r\n        if (props[key] !== item[key]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\nexport class ActivityStore {\r\n    constructor() {\r\n        this.db = datastore({\r\n            filename: 'db/activities.json',\r\n            autoload: true\r\n        })\r\n\r\n    }\r\n    static ensureValidItem(item) {\r\n        const issues = item.validate();\r\n        if (issues.length > 0){\r\n            throw new ValidationError(issues);\r\n        }\r\n    }\r\n\r\n    async insert(item) {\r\n        const it = new Activity(item.id,item.title);\r\n        ItemStore.ensureValidItem(it);\r\n        it.time = item.time;\r\n        it.isDone = item.isDone;\r\n        return this.db.insert(it);\r\n    }\r\n\r\n    findOne = async (id) => this.db.findOne({ id:id });\r\n\r\n    find = async (props) => this.db.find(props);\r\n\r\n    update = async (props, item) => this.db.update(props, item);\r\n\r\n    remove = async (props) => {\r\n        console.log(props);\r\n        this.db.remove(props);\r\n    }\r\n\r\n    count = async (props) => this.db.ccount(props);\r\n\r\n}\r\n\r\nexport default ActivityStore;\r\n\r\n\r\n\r\n\r\n\r\n","export const errorHandler = async (ctx,next) => { // error handler\r\n    try {\r\n        return await next();\r\n    } catch (err) {\r\n        ctx.body = { message: err.message || 'Unexpected error.' };\r\n        ctx.status = err.status || 500;\r\n    }\r\n};\r\n\r\nexport const logger = async(ctx, next) => { //logger function\r\n    let start = Date.now();\r\n    await next();\r\n    console.log(`${ctx.request.method} ${ctx.request.body} ${Date.now() - start} ms`);\r\n};\r\n\r\n\r\n// let id = 0;\r\n// export const idGenerator = {\r\n//     next: () => (++id)\r\n// }\r\n\r\nexport const idGenerator = (() => {\r\n    let id = 0; //nu e distrusa la sfarsitul codului, ci se va pastra (intr-un obiect numit closure, valoarea, pana va fi nevoie de ea)\r\n    return {\r\n        next: () => (++id)\r\n    };\r\n})(); //iie immediately executed function\r\n","module.exports = require(\"@koa/cors\");","module.exports = require(\"fs\");","module.exports = require(\"http\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"koa\");","module.exports = require(\"koa-bodyparser\");","module.exports = require(\"koa-jwt\");","module.exports = require(\"koa-router\");","module.exports = require(\"nedb-promise\");","module.exports = require(\"ws\");"],"sourceRoot":""}